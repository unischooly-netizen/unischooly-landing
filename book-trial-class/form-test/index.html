<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Unischooly ‚Äì Simple Booking Form (Test)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Inter", sans-serif;
      background: #050818;
      color: #e5e7eb;
    }

    .wrapper {
      max-width: 960px;
      margin: 40px auto;
      padding: 24px;
      background: #0b1024;
      border-radius: 16px;
      box-shadow: 0 18px 45px rgba(0, 0, 0, 0.6);
      border: 1px solid rgba(148, 163, 184, 0.35);
    }

    h1 {
      font-size: 24px;
      margin: 0 0 8px;
    }

    .subtitle {
      font-size: 14px;
      color: #9ca3af;
      margin-bottom: 20px;
    }

    .step-indicator {
      font-size: 13px;
      color: #9ca3af;
      margin-bottom: 16px;
    }

    .step-indicator span {
      color: #f97316;
      font-weight: 600;
    }

    .field-group {
      margin-bottom: 14px;
    }

    .field-row {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    label {
      font-size: 13px;
      display: block;
      margin-bottom: 4px;
    }

    input[type="text"],
    input[type="email"],
    select {
      width: 100%;
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #1f2933;
      background: #020617;
      color: #e5e7eb;
      font-size: 14px;
      outline: none;
    }

    input[type="text"]::placeholder,
    input[type="email"]::placeholder {
      color: #6b7280;
    }

    .small-hint {
      font-size: 11px;
      color: #9ca3af;
      margin-top: 4px;
    }

    .pill-toggle {
      display: inline-flex;
      border-radius: 999px;
      padding: 3px;
      background: #020617;
      border: 1px solid #1f2933;
    }

    .pill-toggle button {
      border: none;
      background: transparent;
      color: #9ca3af;
      font-size: 13px;
      padding: 6px 14px;
      border-radius: 999px;
      cursor: pointer;
    }

    .pill-toggle button.active {
      background: linear-gradient(90deg, #f97316, #a855f7, #22d3ee);
      color: #020617;
      font-weight: 600;
    }

    .primary-btn {
      margin-top: 18px;
      width: 100%;
      border-radius: 999px;
      border: none;
      padding: 12px 16px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      background: linear-gradient(90deg, #f97316, #a855f7, #22d3ee);
      color: #020617;
    }

    .note-text {
      margin-top: 6px;
      font-size: 11px;
      color: #9ca3af;
    }

    .hidden {
      display: none;
    }

    .status {
      margin-top: 16px;
      padding: 10px 12px;
      border-radius: 8px;
      font-size: 13px;
    }

    .status.error {
      background: rgba(239, 68, 68, 0.15);
      border: 1px solid rgba(239, 68, 68, 0.7);
      color: #fecaca;
    }

    .status.success {
      background: rgba(16, 185, 129, 0.1);
      border: 1px solid rgba(16, 185, 129, 0.7);
      color: #bbf7d0;
    }

    .pill-list {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 6px;
    }

    .pill-list button {
      border-radius: 999px;
      border: 1px solid #1f2933;
      background: #020617;
      color: #e5e7eb;
      font-size: 13px;
      padding: 6px 12px;
      cursor: pointer;
    }

    .pill-list button.selected {
      background: linear-gradient(90deg, #f97316, #a855f7, #22d3ee);
      color: #020617;
      font-weight: 600;
    }

    .date-buttons, .time-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
    }

    .date-btn, .time-btn {
      border-radius: 10px;
      border: 1px solid #1f2933;
      background: #020617;
      color: #e5e7eb;
      font-size: 13px;
      padding: 8px 10px;
      cursor: pointer;
    }

    .date-btn span {
      display: block;
    }

    .date-btn .top {
      font-size: 12px;
      color: #9ca3af;
    }

    .date-btn .bottom {
      font-size: 13px;
      font-weight: 600;
    }

    .date-btn.selected,
    .time-btn.selected {
      border-color: #22d3ee;
      background: rgba(34, 211, 238, 0.1);
    }

    .time-sub {
      font-size: 11px;
      color: #9ca3af;
      display: block;
    }

    .star-badge {
      display: inline-block;
      background: #f59e0b;
      color: #111827;
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 999px;
      margin-left: 4px;
      font-weight: 600;
    }

    .back-link {
      font-size: 12px;
      color: #60a5fa;
      cursor: pointer;
      margin-bottom: 10px;
      display: inline-block;
    }

    @media (max-width: 720px) {
      .wrapper {
        margin: 12px;
      }
    }
  </style>
</head>
<body>
<div class="wrapper">
  <h1>Unischooly ‚Äì Booking Form (Backend Test)</h1>
  <div class="subtitle">
    Simple 3-step form to test Supabase integration. No fancy design ‚Äì only logic.
  </div>
  <div id="step-indicator" class="step-indicator">
    <span>Step 1</span> of 3 ‚Äì Child & Parent Details
  </div>

  <!-- STEP 1 -->
  <section id="step-1">
    <div class="field-group">
      <label>WhatsApp Number</label>
      <div class="field-row">
        <div style="flex: 0 0 180px;">
          <select id="country-select"></select>
        </div>
        <div style="flex: 1;">
          <input id="phone-input" type="text" placeholder="10‚Äì12 digit number" />
        </div>
      </div>
      <div class="small-hint">
        We‚Äôll send class link & updates here. Please share the number that you use for WhatsApp.
      </div>
    </div>

    <div class="field-row">
      <div class="field-group" style="flex: 1;">
        <label>Child's Name</label>
        <input id="child-name" type="text" placeholder="E.g. Aarav, Emma" />
      </div>
      <div class="field-group" style="flex: 1;">
        <label>Select Child's Grade</label>
        <select id="child-grade">
          <option value="">Select grade</option>
          <option value="Grade 1">Grade 1</option>
          <option value="Grade 2">Grade 2</option>
          <option value="Grade 3">Grade 3</option>
          <option value="Grade 4">Grade 4</option>
          <option value="Grade 5">Grade 5</option>
          <option value="Grade 6">Grade 6</option>
          <option value="Grade 7">Grade 7</option>
          <option value="Grade 8">Grade 8</option>
          <option value="Grade 9">Grade 9</option>
          <option value="Grade 10">Grade 10</option>
          <option value="Grade 11">Grade 11</option>
          <option value="Grade 12">Grade 12</option>
        </select>
      </div>
    </div>

    <div class="field-row">
      <div class="field-group" style="flex: 1;">
        <label>Parent / Guardian Name</label>
        <input id="parent-name" type="text" placeholder="Parent / Guardian full name" />
      </div>
      <div class="field-group" style="flex: 1;">
        <label>Parent's Email</label>
        <input id="parent-email" type="email" placeholder="We will send confirmation here" />
      </div>
    </div>

    <div class="field-group">
      <label>Do you have a Laptop / Desktop for the class?</label>
      <div class="pill-toggle">
        <button id="laptop-yes" class="active" type="button">Yes</button>
        <button id="laptop-no" type="button">No (Tablet / Mobile only)</button>
      </div>
    </div>

    <button id="step1-btn" class="primary-btn" type="button">
      üöÄ Book a Free Trial Class
    </button>
    <div class="note-text">
      Note: We will share the class link & certificate on Email & WhatsApp.
    </div>
  </section>

  <!-- STEP 2 -->
  <section id="step-2" class="hidden">
    <div class="back-link" id="back-to-step1">‚Üê Back to details</div>

    <div class="field-group">
      <label>Select Date</label>
      <div class="small-hint">Your class will be for 1 hour. Showing today + next 5 days.</div>
      <div id="date-buttons" class="date-buttons"></div>
    </div>

    <div class="field-group">
      <label>Select Start Time</label>
      <div class="small-hint">Class slots are limited. Times are shown in your local time.</div>
      <div id="time-buttons" class="time-buttons"></div>
    </div>

    <div class="field-group">
      <label>Select Language</label>
      <select id="language-select">
        <option value="english">English</option>
        <option value="arabic">Arabic</option>
        <option value="bahasa">Bahasa</option>
        <option value="vietnamese">Vietnamese</option>
        <option value="filipino">Filipino</option>
        <option value="thai">Thai</option>
      </select>
    </div>

    <button id="step2-btn" class="primary-btn" type="button">
      ‚ú® Confirm Class Time
    </button>
    <div class="note-text">
      Note: Free class will be conducted by reputed teachers.
      By continuing you agree to be contacted by Unischooly via WhatsApp / Phone / Email.
    </div>
  </section>

  <!-- STEP 3 -->
  <section id="step-3" class="hidden">
    <div class="back-link" id="back-to-step2">‚Üê Back to date & time</div>

    <div class="field-group">
      <label>Who are you?</label>
      <div id="who-group" class="pill-list">
        <button type="button" data-value="Parent" class="selected">Parent</button>
        <button type="button" data-value="Student">Student</button>
        <button type="button" data-value="Guardian">Guardian</button>
      </div>
    </div>

    <div class="field-group">
      <label>Why are you booking this trial class?</label>
      <div id="reason-group" class="pill-list">
        <button type="button" data-value="Want to buy course" class="selected">Want to buy course</button>
        <button type="button" data-value="To Compare Platform">To Compare Platform</button>
        <button type="button" data-value="To strengthen Concept">To strengthen Concept</button>
        <button type="button" data-value="Just for free demo">Just for free demo</button>
      </div>
    </div>

    <div class="field-group">
      <label>When are you planning to purchase?</label>
      <div id="timeline-group" class="pill-list">
        <button type="button" data-value="After the Demo" class="selected">After the Demo</button>
        <button type="button" data-value="This Week">This Week</button>
        <button type="button" data-value="This Month">This Month</button>
        <button type="button" data-value="Just Exploring">Just Exploring</button>
      </div>
    </div>

    <button id="step3-btn" class="primary-btn" type="button">
      ‚úÖ Submit
    </button>
  </section>

  <div id="status" class="status hidden"></div>
</div>

<script type="module">
  import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

  const SUPABASE_URL = "https://binklfyiypbhuzsvnlzg.supabase.co";
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJpbmtsZnlpeXBiaHV6c3ZubHpnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUwMzA5NjgsImV4cCI6MjA4MDYwNjk2OH0.PYCRN7ubQA2XnVy8BYd6746iAGATjBuBAlvsCdLdbqw";

  const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  // --- basic URL params ---
  const url = new URL(window.location.href);
  const search = url.searchParams;
  const courseId = parseInt(search.get("courseId") || search.get("courseid") || "1", 10);
  const langParam = (search.get("lang") || "english").toLowerCase();
  const landingPagePath = url.pathname;
  const fullUrl = url.href;

  // --- simple country mapping ---
  const COUNTRY_CONFIG = {
    IN: { label: "India (+91)", phoneCode: "+91", country: "India", regionKey: "ASIA", timezone: "Asia/Kolkata" },
    AE: { label: "United Arab Emirates (+971)", phoneCode: "+971", country: "United Arab Emirates", regionKey: "MEA", timezone: "Asia/Dubai" },
    SA: { label: "Saudi Arabia (+966)", phoneCode: "+966", country: "Saudi Arabia", regionKey: "MEA", timezone: "Asia/Riyadh" },
    US: { label: "United States ‚Äì New York (+1)", phoneCode: "+1", country: "United States", regionKey: "USA", timezone: "America/New_York" },
    GB: { label: "United Kingdom (+44)", phoneCode: "+44", country: "United Kingdom", regionKey: "EUROPE", timezone: "Europe/London" }
  };

  const DEFAULT_COUNTRY_KEY = "IN";

  // --- state ---
  let selectedCountryKey = DEFAULT_COUNTRY_KEY;
  let hasLaptop = "yes";
  let currentLeadId = null;
  let selectedRegionKey = COUNTRY_CONFIG[DEFAULT_COUNTRY_KEY].regionKey;

  let slotsByDate = {};
  let selectedDateKey = null;
  let selectedSlot = null;

  let whoValue = "Parent";
  let bookingReason = "Want to buy course";
  let purchaseTimeline = "After the Demo";

  // --- DOM helpers ---
  const stepIndicator = document.getElementById("step-indicator");
  const step1Section = document.getElementById("step-1");
  const step2Section = document.getElementById("step-2");
  const step3Section = document.getElementById("step-3");
  const statusBox = document.getElementById("status");

  function setStatus(message, type = "error") {
    statusBox.textContent = message;
    statusBox.classList.remove("hidden", "error", "success");
    statusBox.classList.add(type === "success" ? "success" : "error");
  }

  function clearStatus() {
    statusBox.textContent = "";
    statusBox.classList.add("hidden");
  }

  function showStep(step) {
    step1Section.classList.add("hidden");
    step2Section.classList.add("hidden");
    step3Section.classList.add("hidden");
    clearStatus();

    if (step === 1) {
      step1Section.classList.remove("hidden");
      stepIndicator.innerHTML = '<span>Step 1</span> of 3 ‚Äì Child & Parent Details';
    } else if (step === 2) {
      step2Section.classList.remove("hidden");
      stepIndicator.innerHTML = '<span>Step 2</span> of 3 ‚Äì Date & Time';
    } else {
      step3Section.classList.remove("hidden");
      stepIndicator.innerHTML = '<span>Step 3</span> of 3 ‚Äì Personalisation';
    }
  }

  // --- populate country select ---
  const countrySelect = document.getElementById("country-select");
  function initCountrySelect() {
    countrySelect.innerHTML = "";
    Object.entries(COUNTRY_CONFIG).forEach(([code, cfg]) => {
      const opt = document.createElement("option");
      opt.value = code;
      opt.textContent = cfg.label;
      countrySelect.appendChild(opt);
    });
    countrySelect.value = DEFAULT_COUNTRY_KEY;
  }

  countrySelect.addEventListener("change", () => {
    selectedCountryKey = countrySelect.value;
    selectedRegionKey = COUNTRY_CONFIG[selectedCountryKey].regionKey;
  });

  // --- laptop toggle ---
  const laptopYesBtn = document.getElementById("laptop-yes");
  const laptopNoBtn = document.getElementById("laptop-no");

  laptopYesBtn.addEventListener("click", () => {
    hasLaptop = "yes";
    laptopYesBtn.classList.add("active");
    laptopNoBtn.classList.remove("active");
  });

  laptopNoBtn.addEventListener("click", () => {
    hasLaptop = "no";
    laptopNoBtn.classList.add("active");
    laptopYesBtn.classList.remove("active");
  });

  // --- Step 1 submit ---
  document.getElementById("step1-btn").addEventListener("click", async () => {
    clearStatus();

    const phoneInput = document.getElementById("phone-input").value.trim();
    const childName = document.getElementById("child-name").value.trim();
    const childGrade = document.getElementById("child-grade").value;
    const parentName = document.getElementById("parent-name").value.trim();
    const parentEmail = document.getElementById("parent-email").value.trim();

    if (!phoneInput || !childName || !childGrade || !parentName || !parentEmail) {
      setStatus("Please fill all required fields on Step 1.", "error");
      return;
    }

    const countryCfg = COUNTRY_CONFIG[selectedCountryKey];
    const payload = {
      child_name: childName,
      child_grade: childGrade,
      parent_name: parentName,
      parent_email: parentEmail,
      phone_country_code: countryCfg.phoneCode,
      phone_number: phoneInput,
      has_laptop: hasLaptop,
      region_key: countryCfg.regionKey,
      country: countryCfg.country,
      timezone: countryCfg.timezone,
      lang: langParam,
      course_id: courseId,
      landing_page_path: landingPagePath,
      full_url: fullUrl,
      page_completed: 1
      // ip_address, city etc. could be filled later via backend
    };

    try {
      const { data, error } = await supabase
        .from("demo_leads")
        .upsert(payload, {
          onConflict: "phone_country_code,phone_number"
        })
        .select()
        .single();

      if (error) throw error;

      currentLeadId = data.id;
      selectedRegionKey = data.region_key || selectedRegionKey;

      showStep(2);
      await loadSlotsForRegion();
    } catch (err) {
      console.error(err);
      setStatus("Could not save your details. Please try again in a moment.", "error");
    }
  });

  // --- load slots (Step 2) ---
  const dateButtonsContainer = document.getElementById("date-buttons");
  const timeButtonsContainer = document.getElementById("time-buttons");
  const languageSelect = document.getElementById("language-select");

  languageSelect.value = "english";

  function formatTime12h(timeStr) {
    // expects "HH:MM" or "HH:MM:SS"
    if (!timeStr) return "";
    const parts = timeStr.split(":");
    let h = parseInt(parts[0], 10);
    const m = parts[1] || "00";
    const ampm = h >= 12 ? "PM" : "AM";
    h = h % 12;
    if (h === 0) h = 12;
    return `${String(h).padStart(2, "0")}:${m} ${ampm}`;
  }

  function dateKeyFromISO(d) {
    return d.toISOString().slice(0, 10);
  }

  function labelForDate(dateStr) {
    const today = new Date();
    const d = new Date(dateStr + "T00:00:00");
    const diffDays = Math.round((d - new Date(today.toDateString())) / (1000 * 60 * 60 * 24));

    if (diffDays === 0) return "Today";
    if (diffDays === 1) return "Tomorrow";

    const weekday = d.toLocaleDateString(undefined, { weekday: "long" });
    return weekday;
  }

  function labelBottomForDate(dateStr) {
    const d = new Date(dateStr + "T00:00:00");
    const day = d.getDate();
    const month = d.toLocaleDateString(undefined, { month: "short" });
    return `${day} ${month}`;
  }

  async function loadSlotsForRegion() {
    dateButtonsContainer.innerHTML = "";
    timeButtonsContainer.innerHTML = "";
    slotsByDate = {};
    selectedDateKey = null;
    selectedSlot = null;

    const today = new Date();
    const end = new Date();
    end.setDate(today.getDate() + 5);

    const todayStr = dateKeyFromISO(today);
    const endStr = dateKeyFromISO(end);

    try {
      const { data, error } = await supabase
        .from("demo_slots_live")
        .select("id, slot_date, slot_time_ist, is_star_teacher, region_key, course_id")
        .eq("region_key", selectedRegionKey)
        .eq("course_id", courseId)
        .gte("slot_date", todayStr)
        .lte("slot_date", endStr)
        .order("slot_date", { ascending: true })
        .order("slot_time_ist", { ascending: true });

      if (error) throw error;

      if (!data || data.length === 0) {
        setStatus("No slots found for the next 6 days for this region.", "error");
        return;
      }

      data.forEach((row) => {
        const key = row.slot_date;
        if (!slotsByDate[key]) slotsByDate[key] = [];
        slotsByDate[key].push({
          id: row.id,
          slot_date: row.slot_date,
          slot_time_ist: row.slot_time_ist,
          is_star_teacher: row.is_star_teacher
        });
      });

      renderDateButtons();
    } catch (err) {
      console.error(err);
      setStatus("Could not load slots. Please try again.", "error");
    }
  }

  function renderDateButtons() {
    dateButtonsContainer.innerHTML = "";
    const keys = Object.keys(slotsByDate).sort();

    keys.forEach((dateKey) => {
      const btn = document.createElement("button");
      btn.type = "button";
      btn.className = "date-btn";
      btn.dataset.dateKey = dateKey;

      const top = document.createElement("span");
      top.className = "top";
      top.textContent = labelForDate(dateKey);

      const bottom = document.createElement("span");
      bottom.className = "bottom";
      bottom.textContent = labelBottomForDate(dateKey);

      btn.appendChild(top);
      btn.appendChild(bottom);

      btn.addEventListener("click", () => {
        selectedDateKey = dateKey;
        selectedSlot = null;
        document.querySelectorAll(".date-btn").forEach((b) => b.classList.remove("selected"));
        btn.classList.add("selected");
        renderTimeButtons(dateKey);
      });

      dateButtonsContainer.appendChild(btn);
    });

    // auto-select first date
    if (keys.length > 0) {
      const firstKey = keys[0];
      const firstBtn = dateButtonsContainer.querySelector(`button[data-date-key="${firstKey}"]`);
      if (firstBtn) firstBtn.click();
    }
  }

  function renderTimeButtons(dateKey) {
    timeButtonsContainer.innerHTML = "";
    const slots = slotsByDate[dateKey] || [];

    slots.forEach((slot) => {
      const btn = document.createElement("button");
      btn.type = "button";
      btn.className = "time-btn";

      const label = document.createElement("span");
      label.textContent = formatTime12h(slot.slot_time_ist);

      const sub = document.createElement("span");
      sub.className = "time-sub";
      sub.textContent = "1:1 live class ¬∑ 60 mins";

      label.appendChild(sub);

      btn.appendChild(label);

      if (slot.is_star_teacher) {
        const star = document.createElement("span");
        star.className = "star-badge";
        star.textContent = "Star teacher";
        btn.appendChild(star);
      }

      btn.addEventListener("click", () => {
        selectedSlot = slot;
        document.querySelectorAll(".time-btn").forEach((b) => b.classList.remove("selected"));
        btn.classList.add("selected");
      });

      timeButtonsContainer.appendChild(btn);
    });

    // auto-select first slot
    const first = timeButtonsContainer.querySelector(".time-btn");
    if (first) first.click();
  }

  // --- Step 2 submit ---
  document.getElementById("step2-btn").addEventListener("click", async () => {
    clearStatus();

    if (!currentLeadId) {
      setStatus("Lead not found. Please go back to Step 1.", "error");
      return;
    }

    if (!selectedSlot || !selectedDateKey) {
      setStatus("Please pick a date and time slot.", "error");
      return;
    }

    const langValue = languageSelect.value || "english";

    const updatePayload = {
      preferred_date: selectedSlot.slot_date,
      preferred_time_slot: formatTime12h(selectedSlot.slot_time_ist),
      slot_id: selectedSlot.id,
      star_teacher_selected: !!selectedSlot.is_star_teacher,
      lang: langValue,
      page_completed: 2
    };

    try {
      const { error } = await supabase
        .from("demo_leads")
        .update(updatePayload)
        .eq("id", currentLeadId);

      if (error) throw error;

      showStep(3);
    } catch (err) {
      console.error(err);
      setStatus("Could not save your selected slot. Please try again.", "error");
    }
  });

  // --- Step 3 selections ---
  function initPillGroup(containerId, onChange, defaultValue) {
    const container = document.getElementById(containerId);
    container.addEventListener("click", (e) => {
      const btn = e.target.closest("button[data-value]");
      if (!btn) return;
      container.querySelectorAll("button").forEach((b) => b.classList.remove("selected"));
      btn.classList.add("selected");
      onChange(btn.dataset.value);
    });
    if (defaultValue) {
      const defaultBtn = container.querySelector(`button[data-value="${defaultValue}"]`);
      if (defaultBtn) defaultBtn.classList.add("selected");
    }
  }

  initPillGroup("who-group", (val) => (whoValue = val), whoValue);
  initPillGroup("reason-group", (val) => (bookingReason = val), bookingReason);
  initPillGroup("timeline-group", (val) => (purchaseTimeline = val), purchaseTimeline);

  // --- Step 3 submit ---
  document.getElementById("step3-btn").addEventListener("click", async () => {
    clearStatus();

    if (!currentLeadId) {
      setStatus("Lead not found. Please start again from Step 1.", "error");
      return;
    }

    const updatePayload = {
      who_are_you: whoValue,
      booking_reason: bookingReason,
      purchase_timeline: purchaseTimeline,
      page_completed: 3
    };

    try {
      const { error } = await supabase
        .from("demo_leads")
        .update(updatePayload)
        .eq("id", currentLeadId);

      if (error) throw error;

      setStatus("Your trial class has been booked & saved successfully in Supabase.", "success");
    } catch (err) {
      console.error(err);
      setStatus("Could not save your answers. Please try again.", "error");
    }
  });

  // --- Back buttons ---
  document.getElementById("back-to-step1").addEventListener("click", () => showStep(1));
  document.getElementById("back-to-step2").addEventListener("click", () => showStep(2));

  // --- init on load ---
  initCountrySelect();
  showStep(1);
</script>
</body>
</html>
