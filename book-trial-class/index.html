<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Unischooly ‚Äì Book Free Trial Class</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg-dark: #050816;
      --card-bg: #0b1020;
      --card-border: #1e2744;
      --accent-gradient: linear-gradient(90deg, #ff8bd5, #8e6bff, #5ee7ff);
      --accent-solid: #ff8bd5;
      --accent-solid-2: #ffb347;
      --text-main: #f5f7ff;
      --text-muted: #8f9bbf;
      --text-soft: #5f6a8f;
      --danger: #ff5f7a;
      --success: #5fe3a1;
      --input-bg: #050816;
      --input-border: #2c3559;
      --input-border-focus: #8e6bff;
      --pill-bg: #10172f;
      --pill-bg-soft: #141b33;
      --pill-border: #222b4a;
      --pill-selected-border: #8e6bff;
      --star-bg: #ffeaa7;
      --star-text: #8b4b00;
      --shadow-soft: 0 24px 80px rgba(0,0,0,0.65);
      --radius-lg: 18px;
      --radius-pill: 999px;
      --transition-fast: 0.18s ease-out;
      --transition-med: 0.25s ease;
      --error-bg: rgba(255,95,122,0.08);
      --error-border: rgba(255,95,122,0.6);
    }

    *,
    *::before,
    *::after {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #111827 0, #020617 45%, #000 100%);
      color: var(--text-main);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }

    .booking-shell {
      width: 100%;
      max-width: 1120px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .booking-header {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .booking-eyebrow {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(15,23,42,0.85);
      border: 1px solid rgba(148,163,207,0.25);
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #c7d2fe;
      width: fit-content;
    }

    .booking-eyebrow-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: radial-gradient(circle, #22c55e, #15803d);
      box-shadow: 0 0 8px rgba(34,197,94,0.9);
    }

    .booking-title {
      font-size: 28px;
      font-weight: 700;
      letter-spacing: -0.03em;
    }

    .booking-title span.highlight {
      background: var(--accent-gradient);
      -webkit-background-clip: text;
      color: transparent;
    }

    .booking-subtitle {
      font-size: 14px;
      color: var(--text-muted);
      max-width: 640px;
    }

    .booking-layout {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 0.9fr);
      gap: 22px;
    }

    @media (max-width: 960px) {
      .booking-layout {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .booking-copy-card {
      background: radial-gradient(circle at top left, rgba(56,189,248,0.08), transparent 48%),
                  radial-gradient(circle at bottom right, rgba(244,114,182,0.08), transparent 52%),
                  #020617;
      border-radius: 26px;
      padding: 24px 22px;
      border: 1px solid rgba(30,64,175,0.55);
      box-shadow: 0 30px 90px rgba(15,23,42,0.8);
      position: relative;
      overflow: hidden;
    }

    .booking-copy-card::before {
      content: "";
      position: absolute;
      inset: -120px;
      opacity: 0.16;
      background:
        radial-gradient(circle at 0 0, rgba(251,191,36,0.45), transparent 55%),
        radial-gradient(circle at 100% 0, rgba(96,165,250,0.4), transparent 55%),
        radial-gradient(circle at 0 100%, rgba(244,114,182,0.45), transparent 55%);
      pointer-events: none;
    }

    .booking-copy-inner {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .booking-badges {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 2px;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 5px 10px;
      border-radius: 999px;
      font-size: 11px;
      background: rgba(15,23,42,0.82);
      border: 1px solid rgba(148,163,207,0.3);
      color: #e5e7eb;
      backdrop-filter: blur(10px);
    }

    .badge-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 16px;
      height: 16px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 0, #facc15, #f97316);
      color: #111827;
      font-size: 11px;
      box-shadow: 0 0 10px rgba(251,191,36,0.8);
    }

    .booking-copy-title {
      font-size: 20px;
      font-weight: 600;
    }

    .booking-copy-title span {
      background: var(--accent-gradient);
      -webkit-background-clip: text;
      color: transparent;
    }

    .booking-copy-points {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 4px;
    }

    .copy-point {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      font-size: 13px;
      color: #e5e7eb;
    }

    .copy-bullet {
      margin-top: 2px;
      font-size: 13px;
    }

    .booking-metrics {
      display: flex;
      flex-wrap: wrap;
      gap: 14px;
      margin-top: 8px;
    }

    .metric-pill {
      padding: 8px 11px;
      border-radius: 999px;
      background: rgba(15,23,42,0.9);
      border: 1px solid rgba(55,65,81,0.9);
      font-size: 11px;
      color: #cbd5f5;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .metric-primary-number {
      font-weight: 600;
      color: #e5e7eb;
    }

    .metric-label {
      color: #9ca3af;
    }

    .booking-form-card {
      background: var(--card-bg);
      border-radius: 28px;
      border: 1px solid var(--card-border);
      box-shadow: var(--shadow-soft);
      padding: 20px 20px 24px;
      position: relative;
      overflow: hidden;
    }

    .form-glow {
      position: absolute;
      inset: -160px;
      opacity: 0.1;
      background: radial-gradient(circle at 10% 0, #8b5cf6, transparent 55%),
                  radial-gradient(circle at 90% 100%, #0ea5e9, transparent 55%);
      pointer-events: none;
    }

    .form-inner {
      position: relative;
      z-index: 1;
    }

    .form-header-line {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
      gap: 12px;
    }

    .form-header-title {
      font-size: 16px;
      font-weight: 600;
    }

    .form-header-subtitle {
      font-size: 12px;
      color: var(--text-muted);
    }

    .step-indicator {
      display: flex;
      gap: 10px;
      align-items: center;
      min-width: 190px;
    }

    .progress-track {
      flex: 1;
      height: 6px;
      border-radius: 999px;
      background: #020617;
      border: 1px solid #111827;
      display: flex;
      overflow: hidden;
    }

    .progress-segment {
      flex: 1;
      margin-right: 3px;
      border-radius: 999px;
      background: #020617;
      position: relative;
      overflow: hidden;
    }

    .progress-segment:last-child {
      margin-right: 0;
    }

    .progress-segment.active::before {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: inherit;
      background: var(--accent-gradient);
      box-shadow: 0 0 12px rgba(129,140,248,0.8);
    }

    .progress-segment.completed::before {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: inherit;
      background: radial-gradient(circle at 0 0, #22c55e, #16a34a);
    }

    .step-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-soft);
    }

    .step-label span {
      color: #e5e7eb;
      font-weight: 600;
    }

    .step {
      display: none;
      animation: fadeIn 0.2s ease-out;
    }

    .step.active {
      display: block;
    }

    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(6px);}
      to {opacity: 1; transform: translateY(0);}
    }

    .form-grid {
      display: grid;
      grid-template-columns: minmax(0,1fr);
      gap: 14px;
      margin-top: 6px;
    }

    .form-row-two {
      display: grid;
      grid-template-columns: minmax(0,1.1fr) minmax(0,0.9fr);
      gap: 12px;
    }

    .form-field {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .form-label-row {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 8px;
    }

    label {
      font-size: 12px;
      color: #e5e7eb;
    }

    .label-hint {
      font-size: 11px;
      color: var(--text-soft);
    }

    input[type="text"],
    input[type="email"],
    input[type="tel"],
    select {
      width: 100%;
      border-radius: 999px;
      padding: 9px 13px;
      border: 1px solid var(--input-border);
      background: rgba(15,23,42,0.94);
      color: var(--text-main);
      font-size: 13px;
      outline: none;
      transition: border-color var(--transition-fast), box-shadow var(--transition-fast),
                  background var(--transition-fast), transform 0.08s ease-out;
    }

    input::placeholder {
      color: #64748b;
    }

    input:focus,
    select:focus {
      border-color: var(--input-border-focus);
      box-shadow: 0 0 0 1px rgba(129,140,248,0.6);
      background: #020617;
      transform: translateY(-1px);
    }

    .phone-row {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.3fr);
      gap: 10px;
    }

    .pill-toggle-group {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .pill-toggle {
      padding: 7px 13px;
      border-radius: 999px;
      border: 1px solid var(--pill-border);
      background: var(--pill-bg-soft);
      font-size: 12px;
      color: #d1d5db;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: background var(--transition-fast), border-color var(--transition-fast),
                  transform 0.08s ease-out, box-shadow 0.12s ease-out;
    }

    .pill-toggle span.emoji {
      font-size: 14px;
    }

    .pill-toggle.selected {
      background: radial-gradient(circle at 0 0, rgba(251,191,36,0.4), rgba(129,140,248,0.95));
      border-color: #c4b5fd;
      color: #020617;
      box-shadow: 0 0 18px rgba(129,140,248,0.55);
      transform: translateY(-1px);
    }

    .pill-toggle.selected span.emoji {
      filter: drop-shadow(0 0 10px rgba(251,191,36,0.8));
    }

    .helper-text {
      font-size: 11px;
      color: var(--text-soft);
    }

    .cta-row {
      margin-top: 16px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .btn-primary {
      border: none;
      border-radius: 999px;
      padding: 11px 16px;
      background-image: var(--accent-gradient);
      color: #020617;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: 0 14px 40px rgba(96,165,250,0.5);
      transition: transform 0.12s ease-out, box-shadow 0.12s ease-out, filter 0.12s ease-out;
    }

    .btn-primary:hover {
      transform: translateY(-1.5px);
      filter: brightness(1.05);
      box-shadow: 0 22px 60px rgba(79,70,229,0.65);
    }

    .btn-primary:active {
      transform: translateY(0);
      box-shadow: 0 10px 28px rgba(30,64,175,0.85);
    }

    .btn-primary span.icon {
      font-size: 16px;
    }

    .btn-secondary-link {
      border: none;
      background: none;
      color: var(--text-soft);
      font-size: 12px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      padding: 0;
    }

    .btn-secondary-link span.icon {
      font-size: 14px;
    }

    .small-note {
      font-size: 10px;
      color: var(--text-soft);
      line-height: 1.4;
    }

    .error-banner {
      margin-bottom: 10px;
      padding: 8px 10px;
      border-radius: 10px;
      background: var(--error-bg);
      border: 1px solid var(--error-border);
      color: #fecaca;
      font-size: 11px;
      display: none;
    }

    .error-banner.visible {
      display: block;
    }

    .success-banner {
      margin-bottom: 10px;
      padding: 8px 10px;
      border-radius: 10px;
      background: rgba(22,163,74,0.09);
      border: 1px solid rgba(52,211,153,0.6);
      color: #bbf7d0;
      font-size: 11px;
      display: none;
    }

    .success-banner.visible {
      display: block;
    }

    .slots-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }

    .slot-day-row {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
    }

    @media (max-width: 640px) {
      .slot-day-row {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    .slot-day-card {
      border-radius: 16px;
      padding: 10px 10px 9px;
      background: #020617;
      border: 1px solid var(--pill-border);
      cursor: pointer;
      transition: border-color var(--transition-fast), background var(--transition-fast),
                  box-shadow 0.15s ease-out, transform 0.08s ease-out;
      display: flex;
      flex-direction: column;
      gap: 2px;
      font-size: 11px;
      color: #e5e7eb;
    }

    .slot-day-card span.day-label {
      font-size: 11px;
      color: var(--text-soft);
    }

    .slot-day-card span.date-label {
      font-size: 13px;
      font-weight: 600;
    }

    .slot-day-card.selected {
      border-color: #22c55e;
      background: linear-gradient(145deg, rgba(34,197,94,0.18), rgba(15,23,42,0.95));
      box-shadow: 0 0 0 1px rgba(34,197,94,0.5);
      transform: translateY(-1px);
    }

    .slot-day-card.today-tag {
      position: relative;
    }

    .slot-day-card.today-tag::after {
      content: "Today";
      position: absolute;
      top: 6px;
      right: 8px;
      font-size: 9px;
      padding: 2px 6px;
      border-radius: 999px;
      background: rgba(248,250,252,0.06);
      border: 1px solid rgba(148,163,197,0.4);
      color: #e5e7eb;
    }

    .time-pill {
      border-radius: 999px;
      padding: 7px 10px;
      background: var(--pill-bg);
      border: 1px solid var(--pill-border);
      font-size: 12px;
      color: #e5e7eb;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: background var(--transition-fast), border-color var(--transition-fast),
                  box-shadow 0.12s ease-out, transform 0.08s ease-out;
      white-space: nowrap;
    }

    .time-pill .star-tag {
      font-size: 10px;
      padding: 3px 6px;
      border-radius: 999px;
      background: var(--star-bg);
      color: var(--star-text);
      font-weight: 600;
    }

    .time-pill.selected {
      background: radial-gradient(circle at 0 0, rgba(251,191,36,0.4), rgba(96,165,250,0.9));
      border-color: rgba(191,219,254,0.95);
      color: #020617;
      box-shadow: 0 0 18px rgba(59,130,246,0.7);
      transform: translateY(-1px);
    }

    .time-pill.disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }

    .time-pill.disabled:hover {
      transform: none;
      box-shadow: none;
    }

    .time-pills-wrap {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
    }

    .language-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 6px;
    }

    .language-pill {
      padding: 7px 11px;
      border-radius: 999px;
      border: 1px solid var(--pill-border);
      background: var(--pill-bg-soft);
      font-size: 12px;
      color: #e5e7eb;
      cursor: pointer;
      transition: background var(--transition-fast), border-color var(--transition-fast),
                  transform 0.08s ease-out, box-shadow 0.12s ease-out;
    }

    .language-pill.selected {
      background: radial-gradient(circle at 0 0, rgba(56,189,248,0.6), rgba(129,140,248,0.95));
      border-color: #7dd3fc;
      color: #020617;
      box-shadow: 0 0 18px rgba(56,189,248,0.7);
      transform: translateY(-1px);
    }

    .chips-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
    }

    .chip {
      padding: 7px 12px;
      border-radius: 999px;
      border: 1px solid var(--pill-border);
      background: var(--pill-bg-soft);
      font-size: 12px;
      color: #d1d5db;
      cursor: pointer;
      transition: background var(--transition-fast), border-color var(--transition-fast),
                  transform 0.08s ease-out, box-shadow 0.12s ease-out;
    }

    .chip.selected {
      background: radial-gradient(circle at 0 0, rgba(251,191,36,0.5), rgba(129,140,248,0.9));
      border-color: #eab308;
      color: #020617;
      box-shadow: 0 0 18px rgba(251,191,36,0.7);
      transform: translateY(-1px);
    }

    .step-heading {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .step-subheading {
      font-size: 13px;
      color: var(--text-muted);
      margin-bottom: 14px;
    }

    .mini-muted {
      font-size: 11px;
      color: var(--text-soft);
      margin-top: 10px;
    }

  </style>
</head>
<body>
  <div class="booking-shell">
    <div class="booking-header">
      <div class="booking-eyebrow">
        <span class="booking-eyebrow-dot"></span>
        LIVE 1:1 Free Trial ‚Ä¢ Limited Daily Slots
      </div>
      <div class="booking-title">
        Book Now &amp; <span class="highlight">Get Certified</span>
      </div>
      <div class="booking-subtitle">
        Share your details, pick a slot in your child‚Äôs local time, and we‚Äôll match you with a certified Unischooly teacher for a personalised 1:1 coding trial class.
      </div>
    </div>

    <div class="booking-layout">
      <aside class="booking-copy-card">
        <div class="booking-copy-inner">
          <div class="booking-badges">
            <div class="badge">
              <span class="badge-icon">‚ö°</span>
              Kids in 30+ countries
            </div>
            <div class="badge">
              <span class="badge-icon">üíª</span>
              Live 1:1 project class
            </div>
            <div class="badge">
              <span class="badge-icon">üéì</span>
              Certificate after demo
            </div>
          </div>

          <div class="booking-copy-title">
            Free Live Coding Class <span>for Your Child</span>
          </div>
          <div class="booking-copy-points">
            <div class="copy-point">
              <span class="copy-bullet">‚úÖ</span>
              <span>Personalised 45-minute 1:1 session aligned to your child‚Äôs grade &amp; interest.</span>
            </div>
            <div class="copy-point">
              <span class="copy-bullet">‚úÖ</span>
              <span>Hands-on live project inside the class ‚Äì no boring slides.</span>
            </div>
            <div class="copy-point">
              <span class="copy-bullet">‚úÖ</span>
              <span>Detailed class report &amp; digital certificate shared on WhatsApp &amp; email.</span>
            </div>
          </div>

          <div class="booking-metrics">
            <div class="metric-pill">
              <span class="metric-primary-number">25,000+</span>
              <span class="metric-label">kids taught</span>
            </div>
            <div class="metric-pill">
              <span class="metric-primary-number">45 mins</span>
              <span class="metric-label">live class</span>
            </div>
            <div class="metric-pill">
              <span class="metric-primary-number">4.8‚òÖ</span>
              <span class="metric-label">avg parent rating</span>
            </div>
          </div>
        </div>
      </aside>

      <section class="booking-form-card">
        <div class="form-glow"></div>
        <div class="form-inner">
          <div id="errorBanner" class="error-banner"></div>
          <div id="successBanner" class="success-banner"></div>

          <div class="form-header-line">
            <div>
              <div class="form-header-title">Free Trial Booking Form</div>
              <div class="form-header-subtitle">
                Three quick steps to lock your perfect time slot.
              </div>
            </div>
            <div class="step-indicator">
              <div class="progress-track">
                <div class="progress-segment" data-step-progress="1"></div>
                <div class="progress-segment" data-step-progress="2"></div>
                <div class="progress-segment" data-step-progress="3"></div>
              </div>
              <div class="step-label">
                Step <span id="stepLabel">1</span> of 3
              </div>
            </div>
          </div>

          <!-- STEP 1 -->
          <div id="step1" class="step active">
            <div class="step-heading">Child &amp; Parent Details</div>
            <div class="step-subheading">
              Share quick details so we can personalise the trial in your child‚Äôs local time.
            </div>

            <div class="form-grid">
              <div class="form-field">
                <div class="form-label-row">
                  <label for="countryInput">WhatsApp Number</label>
                  <span class="label-hint">We‚Äôll send class link &amp; updates here</span>
                </div>
                <div class="phone-row">
                  <input
                    type="text"
                    id="countryInput"
                    list="countryOptions"
                    placeholder="Search country (e.g. United Arab Emirates)"
                    autocomplete="off"
                  />
                  <datalist id="countryOptions"></datalist>

                  <input
                    type="tel"
                    id="phoneInput"
                    placeholder="10‚Äì12 digit WhatsApp number"
                    autocomplete="tel"
                  />
                </div>
                <div class="helper-text">
                  Please share the number that you use for WhatsApp.
                </div>
              </div>

              <div class="form-field">
                <div class="form-label-row">
                  <label for="childName">Child‚Äôs Name</label>
                </div>
                <input type="text" id="childName" placeholder="E.g. Aarav, Emma" />
              </div>

              <div class="form-row-two">
                <div class="form-field">
                  <div class="form-label-row">
                    <label for="childGrade">Child‚Äôs Grade</label>
                  </div>
                  <select id="childGrade">
                    <option value="">Select grade</option>
                    <option>Grade 1</option>
                    <option>Grade 2</option>
                    <option>Grade 3</option>
                    <option>Grade 4</option>
                    <option>Grade 5</option>
                    <option>Grade 6</option>
                    <option>Grade 7</option>
                    <option>Grade 8</option>
                    <option>Grade 9</option>
                    <option>Grade 10</option>
                    <option>Grade 11</option>
                    <option>Grade 12</option>
                  </select>
                </div>
                <div class="form-field">
                  <div class="form-label-row">
                    <label for="parentName">Parent / Guardian Name</label>
                  </div>
                  <input type="text" id="parentName" placeholder="Full name" />
                </div>
              </div>

              <div class="form-field">
                <div class="form-label-row">
                  <label for="parentEmail">Parent‚Äôs Email</label>
                </div>
                <input type="email" id="parentEmail" placeholder="We‚Äôll send confirmation here" />
              </div>

              <div class="form-field">
                <div class="form-label-row">
                  <label>Does your child have a Laptop / Desktop?</label>
                </div>
                <div class="pill-toggle-group" id="deviceToggleGroup">
                  <button class="pill-toggle" type="button" data-value="yes">
                    <span class="emoji">üíª</span> Yes
                  </button>
                  <button class="pill-toggle" type="button" data-value="no">
                    <span class="emoji">üì±</span> No (Tablet / Mobile only)
                  </button>
                </div>
              </div>
            </div>

            <div class="cta-row">
              <button id="step1Next" class="btn-primary" type="button">
                <span class="icon">üöÄ</span>
                <span>Book a Free Trial Class</span>
              </button>
              <div class="small-note">
                We will share the class link &amp; certificate on Email &amp; WhatsApp.
              </div>
            </div>
          </div>

          <!-- STEP 2 -->
          <div id="step2" class="step">
            <div class="step-heading">Select Date &amp; Time</div>
            <div class="step-subheading">
              Pick a 1-hour slot that works best in your child‚Äôs local time zone.
            </div>

            <div class="form-grid">
              <div class="form-field">
                <div class="form-label-row">
                  <label>Select Date</label>
                  <span class="label-hint">Your class will be for 1 hour</span>
                </div>
                <div id="dateGrid" class="slot-day-row"></div>
              </div>

              <div class="form-field">
                <div class="form-label-row">
                  <label>Select Start Time</label>
                  <span class="label-hint">Class slots are limited. Times are shown in your local time zone.</span>
                </div>
                <div id="timeGrid" class="time-pills-wrap"></div>
              </div>

              <div class="form-field">
                <div class="form-label-row">
                  <label>Select Language</label>
                </div>
                <div id="languageGrid" class="language-grid">
                  <button class="language-pill" type="button" data-lang="English">English</button>
                  <button class="language-pill" type="button" data-lang="Arabic">Arabic</button>
                  <button class="language-pill" type="button" data-lang="Bahasa">Bahasa</button>
                  <button class="language-pill" type="button" data-lang="Vietnamese">Vietnamese</button>
                  <button class="language-pill" type="button" data-lang="Filipino">Filipino</button>
                  <button class="language-pill" type="button" data-lang="Thai">Thai</button>
                </div>
              </div>
            </div>

            <div class="cta-row">
              <div style="display:flex;justify-content:space-between;align-items:center;gap:8px;margin-bottom:4px;">
                <button id="backToStep1" class="btn-secondary-link" type="button">
                  <span class="icon">‚Üê</span>
                  <span>Go back to details</span>
                </button>
              </div>
              <button id="step2Next" class="btn-primary" type="button">
                <span class="icon">‚ú®</span>
                <span>Confirm Class Time</span>
              </button>
              <div class="small-note">
                Free class will be conducted by reputed teachers.
                By continuing I agree to be contacted by Unischooly via WhatsApp / Phone / Email for this booking.
              </div>
            </div>
          </div>

          <!-- STEP 3 -->
          <div id="step3" class="step">
            <div class="step-heading">Help us personalise your experience</div>
            <div class="step-subheading">
              A few quick questions so we can match you with the right mentor &amp; learning path.
            </div>

            <div class="form-grid">
              <div class="form-field">
                <div class="form-label-row">
                  <label>Who are you?</label>
                </div>
                <div id="whoYouAreChips" class="chips-row">
                  <button class="chip" type="button" data-value="Parent">Parent</button>
                  <button class="chip" type="button" data-value="Student">Student</button>
                  <button class="chip" type="button" data-value="Guardian">Guardian</button>
                </div>
              </div>

              <div class="form-field">
                <div class="form-label-row">
                  <label>Why are you booking this trial class?</label>
                </div>
                <div id="bookingReasonChips" class="chips-row">
                  <button class="chip" type="button" data-value="Want to buy course">Want to buy course</button>
                  <button class="chip" type="button" data-value="To Compare Platform">To Compare Platform</button>
                  <button class="chip" type="button" data-value="To strengthen concept">To strengthen Concept</button>
                  <button class="chip" type="button" data-value="Just for free demo">Just for free demo</button>
                </div>
              </div>

              <div class="form-field">
                <div class="form-label-row">
                  <label>When are you planning to purchase?</label>
                </div>
                <div id="purchaseIntentChips" class="chips-row">
                  <button class="chip" type="button" data-value="After the Demo">After the Demo</button>
                  <button class="chip" type="button" data-value="This Week">This Week</button>
                  <button class="chip" type="button" data-value="This Month">This Month</button>
                  <button class="chip" type="button" data-value="Just Exploring">Just Exploring</button>
                </div>
              </div>
            </div>

            <div class="cta-row">
              <div style="display:flex;justify-content:space-between;align-items:center;gap:8px;margin-bottom:4px;">
                <button id="backToStep2" class="btn-secondary-link" type="button">
                  <span class="icon">‚Üê</span>
                  <span>Back to time selection</span>
                </button>
              </div>
              <button id="step3Submit" class="btn-primary" type="button">
                <span class="icon">‚úÖ</span>
                <span>Submit</span>
              </button>
              <div class="small-note">
                After submitting, we‚Äôll show your booking confirmation and send all details on WhatsApp &amp; email.
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>

  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script>
    /*********************************************************
     * CONFIG
     *********************************************************/
    const SUPABASE_URL = "https://binklfyiypbhuzsvnlzg.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJpbmtsZnlpeXBiaHV6c3ZubHpnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUwMzA5NjgsImV4cCI6MjA4MDYwNjk2OH0.PYCRN7ubQA2XnVy8BYd6746iAGATjBuBAlvsCdLdbqw";

    const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // Simple country-to-region mapping (expand as needed)
    const COUNTRY_DATA = [
      { label: "India (+91)", iso2: "IN", dialCode: "+91", region: "ASIA" },
      { label: "United Arab Emirates (+971)", iso2: "AE", dialCode: "+971", region: "MEA" },
      { label: "Saudi Arabia (+966)", iso2: "SA", dialCode: "+966", region: "MEA" },
      { label: "Qatar (+974)", iso2: "QA", dialCode: "+974", region: "MEA" },
      { label: "Kuwait (+965)", iso2: "KW", dialCode: "+965", region: "MEA" },
      { label: "Bahrain (+973)", iso2: "BH", dialCode: "+973", region: "MEA" },
      { label: "Oman (+968)", iso2: "OM", dialCode: "+968", region: "MEA" },
      { label: "United States (+1)", iso2: "US", dialCode: "+1", region: "USA" },
      { label: "Canada (+1)", iso2: "CA", dialCode: "+1", region: "USA" },
      { label: "United Kingdom (+44)", iso2: "GB", dialCode: "+44", region: "EUROPE" },
      { label: "Germany (+49)", iso2: "DE", dialCode: "+49", region: "EUROPE" },
      { label: "France (+33)", iso2: "FR", dialCode: "+33", region: "EUROPE" },
      { label: "Spain (+34)", iso2: "ES", dialCode: "+34", region: "EUROPE" },
      { label: "Italy (+39)", iso2: "IT", dialCode: "+39", region: "EUROPE" },
      { label: "Netherlands (+31)", iso2: "NL", dialCode: "+31", region: "EUROPE" },
      { label: "Sweden (+46)", iso2: "SE", dialCode: "+46", region: "EUROPE" },
      { label: "Norway (+47)", iso2: "NO", dialCode: "+47", region: "EUROPE" },
      { label: "Denmark (+45)", iso2: "DK", dialCode: "+45", region: "EUROPE" },
      { label: "Ireland (+353)", iso2: "IE", dialCode: "+353", region: "EUROPE" },
      { label: "Singapore (+65)", iso2: "SG", dialCode: "+65", region: "SEA" },
      { label: "Malaysia (+60)", iso2: "MY", dialCode: "+60", region: "SEA" },
      { label: "Indonesia (+62)", iso2: "ID", dialCode: "+62", region: "SEA" },
      { label: "Philippines (+63)", iso2: "PH", dialCode: "+63", region: "SEA" },
      { label: "Thailand (+66)", iso2: "TH", dialCode: "+66", region: "SEA" },
      { label: "Vietnam (+84)", iso2: "VN", dialCode: "+84", region: "SEA" },
      { label: "Australia (+61)", iso2: "AU", dialCode: "+61", region: "ANZ" },
      { label: "New Zealand (+64)", iso2: "NZ", dialCode: "+64", region: "ANZ" },
      { label: "South Africa (+27)", iso2: "ZA", dialCode: "+27", region: "ROW" },
      { label: "Nigeria (+234)", iso2: "NG", dialCode: "+234", region: "ROW" },
      { label: "Kenya (+254)", iso2: "KE", dialCode: "+254", region: "ROW" },
      { label: "Brazil (+55)", iso2: "BR", dialCode: "+55", region: "ROW" },
      { label: "Mexico (+52)", iso2: "MX", dialCode: "+52", region: "ROW" },
      { label: "Pakistan (+92)", iso2: "PK", dialCode: "+92", region: "ASIA" },
      { label: "Bangladesh (+880)", iso2: "BD", dialCode: "+880", region: "ASIA" },
      { label: "Sri Lanka (+94)", iso2: "LK", dialCode: "+94", region: "ASIA" },
      { label: "Nepal (+977)", iso2: "NP", dialCode: "+977", region: "ASIA" }
    ];

    const DEFAULT_COUNTRY_ISO2 = "IN";

    /*********************************************************
     * STATE
     *********************************************************/
    let currentStep = 1;
    let currentLeadId = null;
    let selectedCountry = null;
    let selectedDevice = null;

    let selectedDateKey = null;
    let selectedSlot = null;
    let selectedLanguage = null;

    let personaType = null;
    let bookingReason = null;
    let purchaseIntent = null;

    const errorBanner = document.getElementById("errorBanner");
    const successBanner = document.getElementById("successBanner");

    /*********************************************************
     * UTILS
     *********************************************************/
    function showError(msg) {
      errorBanner.textContent = msg;
      errorBanner.classList.add("visible");
      setTimeout(() => {
        errorBanner.classList.remove("visible");
      }, 6000);
    }

    function showSuccess(msg) {
      successBanner.textContent = msg;
      successBanner.classList.add("visible");
      setTimeout(() => {
        successBanner.classList.remove("visible");
      }, 5000);
    }

    function setStep(step) {
      currentStep = step;
      document.querySelectorAll(".step").forEach(s => s.classList.remove("active"));
      document.getElementById("step" + step).classList.add("active");
      document.getElementById("stepLabel").textContent = step;

      const segments = document.querySelectorAll("[data-step-progress]");
      segments.forEach(seg => {
        const val = parseInt(seg.getAttribute("data-step-progress"), 10);
        seg.classList.remove("active", "completed");
        if (val < step) seg.classList.add("completed");
        else if (val === step) seg.classList.add("active");
      });
    }

    function getCourseIdFromUrl() {
      const params = new URLSearchParams(window.location.search);
      const cid = params.get("courseId");
      return cid ? parseInt(cid, 10) : null;
    }

    function formatLocalDate(dateStr) {
      const d = new Date(dateStr);
      const options = { weekday: "short", day: "2-digit", month: "short" };
      const parts = d.toLocaleDateString(undefined, options).split(" ");
      return {
        weekday: parts[0],
        dayMonth: parts.slice(1).join(" ")
      };
    }

    function formatLocalTime(isoString) {
      const d = new Date(isoString);
      return d.toLocaleTimeString([], { hour: "numeric", minute: "2-digit" });
    }

    function todayISO() {
      const now = new Date();
      return now.toISOString().slice(0, 10);
    }

    function addDays(dateStr, days) {
      const d = new Date(dateStr);
      d.setDate(d.getDate() + days);
      return d.toISOString().slice(0, 10);
    }

    function findCountryByLabel(label) {
      return COUNTRY_DATA.find(c => c.label === label);
    }

    function getDefaultCountry() {
      const navLang = navigator.language || navigator.userLanguage || "";
      if (navLang.startsWith("en-US")) return COUNTRY_DATA.find(c => c.iso2 === "US");
      if (navLang.startsWith("en-GB")) return COUNTRY_DATA.find(c => c.iso2 === "GB");
      if (navLang.startsWith("en-AU")) return COUNTRY_DATA.find(c => c.iso2 === "AU");
      if (navLang.startsWith("en-CA")) return COUNTRY_DATA.find(c => c.iso2 === "CA");
      if (navLang.startsWith("en-IN") || navLang.startsWith("hi-") || navLang === "en") {
        return COUNTRY_DATA.find(c => c.iso2 === "IN");
      }
      return COUNTRY_DATA.find(c => c.iso2 === DEFAULT_COUNTRY_ISO2);
    }

    /*********************************************************
     * STEP 1 ‚Äì INIT & HANDLERS
     *********************************************************/
    function initCountryInput() {
      const datalist = document.getElementById("countryOptions");
      COUNTRY_DATA.forEach(c => {
        const opt = document.createElement("option");
        opt.value = c.label;
        datalist.appendChild(opt);
      });

      const defaultCountry = getDefaultCountry();
      const countryInput = document.getElementById("countryInput");
      if (defaultCountry) {
        countryInput.value = defaultCountry.label;
        selectedCountry = defaultCountry;
      } else {
        countryInput.placeholder = "Search country";
      }

      countryInput.addEventListener("change", () => {
        const val = countryInput.value.trim();
        const found = findCountryByLabel(val);
        if (found) {
          selectedCountry = found;
        } else {
          selectedCountry = null;
          showError("Please select a country from the suggestions list.");
        }
      });
    }

    function initDeviceToggle() {
      const group = document.getElementById("deviceToggleGroup");
      group.addEventListener("click", e => {
        const btn = e.target.closest(".pill-toggle");
        if (!btn) return;
        group.querySelectorAll(".pill-toggle").forEach(b => b.classList.remove("selected"));
        btn.classList.add("selected");
        selectedDevice = btn.getAttribute("data-value");
      });
    }

    async function handleStep1Next() {
      const phoneVal = document.getElementById("phoneInput").value.trim();
      const childName = document.getElementById("childName").value.trim();
      const grade = document.getElementById("childGrade").value;
      const parentName = document.getElementById("parentName").value.trim();
      const parentEmail = document.getElementById("parentEmail").value.trim();

      if (!selectedCountry) {
        showError("Please select your country from the suggestions list.");
        return;
      }
      if (!phoneVal) {
        showError("Please enter your WhatsApp number.");
        return;
      }
      if (!childName) {
        showError("Please enter your child‚Äôs name.");
        return;
      }
      if (!grade) {
        showError("Please select your child‚Äôs grade.");
        return;
      }
      if (!parentName) {
        showError("Please enter the parent / guardian name.");
        return;
      }
      if (!parentEmail) {
        showError("Please enter a valid email address.");
        return;
      }
      if (!selectedDevice) {
        showError("Please tell us if you have a laptop or desktop for the class.");
        return;
      }

      const courseId = getCourseIdFromUrl();
      if (!courseId) {
        showError("courseId is missing in the URL. Please open the correct booking link.");
        return;
      }

      const regionKey = selectedCountry.region || "ROW";
      const fullPhone = `${selectedCountry.dialCode} ${phoneVal}`;

      try {
        const insertPayload = {
          course_id: courseId,
          parent_name: parentName,
          parent_email: parentEmail,
          child_name: childName,
          child_grade: grade,
          whatsapp_number: fullPhone,
          whatsapp_raw_number: phoneVal,
          country_label: selectedCountry.label,
          country_iso2: selectedCountry.iso2,
          region_key: regionKey,
          has_laptop: selectedDevice === "yes",
          source: "unischooly_booking_form_v2"
        };

        const { data, error } = await supabaseClient
          .from("demo_leads")
          .insert(insertPayload)
          .select("id, region_key")
          .single();

        if (error) {
          console.error(error);
          showError("Unable to save your details. Please try again in a moment.");
          return;
        }
        currentLeadId = data.id;

        setStep(2);
        await loadSlotsForLead();
      } catch (err) {
        console.error(err);
        showError("Something went wrong while saving your details. Please try again.");
      }
    }

    /*********************************************************
     * STEP 2 ‚Äì SLOTS & LANGUAGE
     *********************************************************/
    function buildDateButtonsFromSlots(slots) {
      const dateGrid = document.getElementById("dateGrid");
      dateGrid.innerHTML = "";

      const daysMap = new Map();
      slots.forEach(slot => {
        const dayKey = slot.slot_date;
        if (!daysMap.has(dayKey)) {
          daysMap.set(dayKey, []);
        }
        daysMap.get(dayKey).push(slot);
      });

      const today = todayISO();
      const todayPlus5 = addDays(today, 5);

      const allDayKeys = Array.from(daysMap.keys())
        .filter(d => d >= today && d <= todayPlus5)
        .sort();

      allDayKeys.forEach(dayKey => {
        const { weekday, dayMonth } = formatLocalDate(dayKey);
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "slot-day-card";
        if (dayKey === today) {
          btn.classList.add("today-tag");
        }
        btn.dataset.dateKey = dayKey;

        btn.innerHTML = `
          <span class="day-label">${weekday}</span>
          <span class="date-label">${dayMonth}</span>
        `;

        btn.addEventListener("click", () => {
          selectedDateKey = dayKey;
          selectedSlot = null;
          document.querySelectorAll(".slot-day-card").forEach(b => b.classList.remove("selected"));
          btn.classList.add("selected");
          buildTimeButtonsForDate(slots, dayKey);
        });

        dateGrid.appendChild(btn);
      });

      if (allDayKeys.length) {
        const firstDay = allDayKeys[0];
        const firstBtn = dateGrid.querySelector(`[data-date-key="${firstDay}"]`);
        if (firstBtn) firstBtn.click();
      }
    }

    function buildTimeButtonsForDate(slots, dateKey) {
      const timeGrid = document.getElementById("timeGrid");
      timeGrid.innerHTML = "";
      const nowPlus1hISO = new Date(Date.now() + 60 * 60 * 1000).toISOString();

      const relevantSlots = slots
        .filter(s => s.slot_date === dateKey)
        .sort((a, b) => new Date(a.slot_datetime_ist) - new Date(b.slot_datetime_ist));

      relevantSlots.forEach(slot => {
        const localTime = formatLocalTime(slot.slot_datetime_ist);
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "time-pill";

        if (slot.capacity_remaining !== null && slot.capacity_remaining <= 0) {
          btn.classList.add("disabled");
        }

        if (slot.slot_datetime_ist <= nowPlus1hISO && slot.slot_date === todayISO()) {
          btn.classList.add("disabled");
        }

        btn.dataset.slotId = slot.id;

        let starMarkup = "";
        if (slot.is_star_teacher) {
          starMarkup = `<span class="star-tag">‚≠ê Star Teacher</span>`;
        }

        btn.innerHTML = `
          <span>${localTime}</span>
          ${starMarkup}
        `;

        btn.addEventListener("click", () => {
          if (btn.classList.contains("disabled")) return;
          selectedSlot = slot;
          document.querySelectorAll(".time-pill").forEach(b => b.classList.remove("selected"));
          btn.classList.add("selected");
        });

        timeGrid.appendChild(btn);
      });
    }

    async function loadSlotsForLead() {
      if (!currentLeadId) return;
      const courseId = getCourseIdFromUrl();
      if (!courseId) {
        showError("courseId is missing in the URL.");
        return;
      }

      try {
        const { data: leadData, error: leadErr } = await supabaseClient
          .from("demo_leads")
          .select("region_key")
          .eq("id", currentLeadId)
          .single();

        if (leadErr) {
          console.error(leadErr);
          showError("Could not fetch your booking details. Please refresh and try again.");
          return;
        }

        const regionKey = leadData.region_key || "ROW";
        const today = todayISO();
        const endDate = addDays(today, 5);
        const nowPlus1hISO = new Date(Date.now() + 60 * 60 * 1000).toISOString();

        const { data: slots, error } = await supabaseClient
          .from("demo_slots_live")
          .select("id, region_key, course_id, slot_date, slot_time_ist, slot_datetime_ist, is_star_teacher, capacity_remaining, is_active")
          .eq("course_id", courseId)
          .eq("region_key", regionKey)
          .eq("is_active", true)
          .gte("slot_date", today)
          .lte("slot_date", endDate)
          .gt("slot_datetime_ist", nowPlus1hISO)
          .order("slot_datetime_ist", { ascending: true });

        if (error) {
          console.error(error);
          showError("Unable to load available slots right now. Please try again shortly.");
          return;
        }

        if (!slots || !slots.length) {
          showError("No upcoming slots are available for this course in your region. Please contact support.");
          return;
        }

        buildDateButtonsFromSlots(slots);
      } catch (err) {
        console.error(err);
        showError("Something went wrong while loading slots. Please refresh and try again.");
      }
    }

    function initLanguageSelection() {
      const grid = document.getElementById("languageGrid");
      grid.addEventListener("click", e => {
        const btn = e.target.closest(".language-pill");
        if (!btn) return;
        grid.querySelectorAll(".language-pill").forEach(b => b.classList.remove("selected"));
        btn.classList.add("selected");
        selectedLanguage = btn.getAttribute("data-lang");
      });
    }

    async function handleStep2Next() {
      if (!selectedSlot) {
        showError("Please select a date and time for your class.");
        return;
      }
      if (!selectedLanguage) {
        showError("Please select your preferred language for the class.");
        return;
      }
      if (!currentLeadId) {
        showError("We could not find your booking details. Please go back and fill Step 1 again.");
        return;
      }

      try {
        const updatePayload = {
          preferred_date: selectedSlot.slot_date,
          preferred_time_slot: selectedSlot.slot_time_ist,
          preferred_slot_datetime_ist: selectedSlot.slot_datetime_ist,
          preferred_language: selectedLanguage,
          selected_slot_id: selectedSlot.id
        };

        const { error } = await supabaseClient
          .from("demo_leads")
          .update(updatePayload)
          .eq("id", currentLeadId);

        if (error) {
          console.error(error);
          showError("Unable to save your selected time. Please try again.");
          return;
        }

        showSuccess("Your class time has been locked successfully.");
        setStep(3);
      } catch (err) {
        console.error(err);
        showError("Something went wrong while saving your slot. Please try again.");
      }
    }

    /*********************************************************
     * STEP 3 ‚Äì MOTIVATION
     *********************************************************/
    function initChipGroup(containerId, onChange) {
      const container = document.getElementById(containerId);
      container.addEventListener("click", e => {
        const chip = e.target.closest(".chip");
        if (!chip) return;
        container.querySelectorAll(".chip").forEach(c => c.classList.remove("selected"));
        chip.classList.add("selected");
        const val = chip.getAttribute("data-value");
        onChange(val);
      });
    }

    async function handleStep3Submit() {
      if (!currentLeadId) {
        showError("We could not find your booking details. Please refresh and start again.");
        return;
      }
      if (!personaType || !bookingReason || !purchaseIntent) {
        showError("Please answer all three questions so we can personalise your trial.");
        return;
      }

      try {
        const { error } = await supabaseClient
          .from("demo_leads")
          .update({
            persona_type: personaType,
            booking_reason: bookingReason,
            purchase_intent: purchaseIntent
          })
          .eq("id", currentLeadId);

        if (error) {
          console.error(error);
          showError("Unable to save your preferences. Please try again.");
          return;
        }

        showSuccess("Your responses are saved. Redirecting to confirmation...");
        setTimeout(() => {
          window.location.href = "/thank-you"; // replace with actual
        }, 1800);
      } catch (err) {
        console.error(err);
        showError("Something went wrong while submitting. Please try again.");
      }
    }

    /*********************************************************
     * INIT
     *********************************************************/
    document.addEventListener("DOMContentLoaded", () => {
      initCountryInput();
      initDeviceToggle();
      initLanguageSelection();

      document.getElementById("step1Next").addEventListener("click", handleStep1Next);
      document.getElementById("backToStep1").addEventListener("click", () => setStep(1));
      document.getElementById("step2Next").addEventListener("click", handleStep2Next);
      document.getElementById("backToStep2").addEventListener("click", () => setStep(2));
      document.getElementById("step3Submit").addEventListener("click", handleStep3Submit);

      initChipGroup("whoYouAreChips", val => (personaType = val));
      initChipGroup("bookingReasonChips", val => (bookingReason = val));
      initChipGroup("purchaseIntentChips", val => (purchaseIntent = val));
    });
  </script>
</body>
</html>
